# reData v0.1.2 产品需求文档

## 文档索引

| 文档 | 说明 |
|------|------|
| [design.md](./design.md) | 技术设计：数据结构、API 接口、实现方案 |
| [plan.md](./plan.md) | 实现计划：阶段划分、依赖关系、风险评估 |
| [dev.md](./dev.md) | 开发记录：进度跟踪、问题记录、验收清单 |

---

## 1. 版本概述

v0.1.2 版本主要解决三个核心问题：

1. **导入撤回与重新导入**：支持撤回整个任务、单个文件或单个 Sheet 的导入数据
2. **数据结果筛选增强**：完善结果页面的筛选功能，支持更多维度的数据过滤
3. **项目列表分组管理**：优化项目列表布局，支持分组管理和拖拽归类

### 版本背景

| 问题 | 现状 | 解决思路 |
|------|------|---------|
| 导入错误无法撤回 | 只能手动逐条删除或重建项目 | 提供灵活的撤回机制，本地处理后重新导入 |
| 筛选功能不足 | 仅支持全文搜索 | 支持多维度组合筛选 |
| 项目列表组织困难 | 无法按类型分类 | 类似文件管理器的分组布局 |

---

## 2. 功能一：导入撤回与重新导入

### 2.1 功能描述

支持灵活的导入撤回机制：
- **撤回整个任务**：删除一次处理任务导入的所有数据
- **撤回单个文件**：删除指定文件导入的数据
- **撤回单个 Sheet**：删除指定文件中某个 Sheet 的数据

### 2.2 用户场景

| 场景 | 操作流程 |
|------|---------|
| AI 映射错误 | 查看结果 → 发现映射有误 → 撤回该 Sheet → 重新导入 |
| 多表格拼合 | 导入后发现格式混乱 → 撤回整个文件 → 本地拆分 Excel → 分别重新导入 |
| 误导入文件 | 误操作导入错误文件 → 撤回该文件 → 数据恢复 |
| 批量导入部分失败 | 5个文件中3个成功2个失败 → 撤回失败文件 → 修复后重新导入 |

### 2.3 UI 设计

#### 结果页面撤回入口

```
┌─────────────────────────────────────────────────────────────┐
│ 数据结果                                    共 1,234 条记录  │
├─────────────────────────────────────────────────────────────┤
│ 📊 数据来源                                                  │
│ ┌─────────────────────────────────────────────────────────┐│
│ │ 批次 #2024021901 (2024-02-19 10:30)              [撤回] ││
│ │ ├─ 📄 客户数据A.xlsx                              [撤回] ││
│ │ │   ├─ Sheet1: 128 条 ✅                   [撤回此Sheet]││
│ │ │   └─ Sheet2: 256 条 ✅                   [撤回此Sheet]││
│ │ └─ 📄 客户数据B.xlsx                              [撤回] ││
│ └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

---

## 3. 功能二：数据结果筛选增强

### 3.1 功能描述

为结果页面提供多维度的数据筛选能力。

### 3.2 筛选维度

| 维度 | 类型 | 说明 |
|------|------|------|
| 全文搜索 | 文本 | 搜索所有字段内容 |
| 字段筛选 | 字段类型相关 | 按特定字段的值筛选 |
| 导入时间 | 日期范围 | 按记录导入时间筛选 |
| 来源文件 | 下拉选择 | 按导入的源文件筛选 |
| 批次 | 下拉选择 | 按处理批次筛选 |

### 3.3 字段筛选运算符

| 字段类型 | 支持的运算符 |
|---------|-------------|
| text | 等于、不等于、包含、不包含、开头为、结尾为、为空、不为空 |
| phone | 等于、不等于、开头为、结尾为、为空、不为空 |
| email | 等于、不等于、包含、开头为、为空、不为空 |
| number | 等于、不等于、大于、小于、大于等于、小于等于、在范围内 |
| date | 等于、早于、晚于、在范围内、为空、不为空 |

### 3.4 UI 设计

```
┌─────────────────────────────────────────────────────────────┐
│ 🔍 全文搜索...                              [重置] [应用筛选] │
├─────────────────────────────────────────────────────────────┤
│ + 添加筛选条件                                                │
│ ┌──────────────────────────────────────────────────────────┐│
│ │ 字段    │ 运算符    │ 值                         │ 操作   ││
│ ├──────────────────────────────────────────────────────────┤│
│ │ 姓名    │ 包含      │ [张三                    ] │ [删除] ││
│ │ 手机号  │ 开头为    │ [138                     ] │ [删除] ││
│ └──────────────────────────────────────────────────────────┘│
│                                                              │
│ 来源文件: [全部 ▼]  批次: [全部 ▼]  状态: [全部 ▼]           │
└─────────────────────────────────────────────────────────────┘
```

---

## 4. 功能三：项目列表分组管理

### 4.1 功能描述

优化项目列表页面，采用类似电脑文件管理器的布局：
- 左侧显示分组列表（侧边栏）
- 右侧显示当前分组下的项目（内容区）
- 支持拖拽项目到分组进行归类

### 4.2 UI 设计

```
┌─────────────────────────────────────────────────────────────────────┐
│  🔍 搜索项目...                                    [+ 新建项目]     │
├────────────────┬────────────────────────────────────────────────────┤
│  📁 全部 (12)   │   ┌──────────┐  ┌──────────┐  ┌──────────┐       │
│                │   │ 客户信息  │  │ 订单数据  │  │ 员工名录  │       │
│  📁 工作项目    │   │ 3 字段   │  │ 5 字段   │  │ 8 字段   │       │
│     客户管理(5) │   │ 128 条   │  │ 1,024 条 │  │ 56 条    │       │
│     订单处理(3) │   └──────────┘  └──────────┘  └──────────┘       │
│     数据清洗(2) │                                                    │
│                │   ┌──────────┐  ┌──────────┐                     │
│  📁 个人项目    │   │ 供应商   │  │ 产品库存  │                     │
│     测试(2)    │   │ 6 字段   │  │ 4 字段   │                     │
│                │   └──────────┘  └──────────┘                     │
│  ────────────  │                                                    │
│  + 新建分组    │                                                    │
└────────────────┴────────────────────────────────────────────────────┘
```

### 4.3 交互说明

| 操作 | 行为 |
|------|------|
| 拖拽项目 | 拖拽项目卡片到分组进行归类 |
| 新建分组 | 弹出输入框，输入名称后创建 |
| 新建子分组 | 在父分组下创建，支持嵌套 |
| 删除分组 | 确认后删除，下属项目移至未分组 |

---

## 5. 实现状态

| 阶段 | 内容 | 状态 |
|------|------|------|
| 阶段1 | 导入撤回后端 API + 数据库变更 | ✅ 已完成 |
| 阶段2 | 导入撤回前端 UI + 批次详情展示 | ✅ 已完成 |
| 阶段3 | 项目分组 UI + 后端 API | ✅ 已完成 |
| 阶段4 | 筛选条件 UI + 后端查询 | 🔲 待开发 |
| 阶段5 | 筛选预设 + 整体优化测试 | 🔲 待开发 |

详细信息请参考 [plan.md](./plan.md) 和 [dev.md](./dev.md)。

---

## 6. 后续规划

- **v0.1.3**: 数据导出、批量编辑、数据统计图表
- **v0.1.4**: 自定义字段类型、高级筛选模板、项目收藏/置顶

---

**文档版本**: v0.1.2-prd
**创建日期**: 2026-02-19
**作者**: Claude Code
