# CLAUDE.md

æœ¬æ–‡ä»¶ä¸º Claude Code (claude.ai/code) åœ¨æ­¤ä»£ç åº“ä¸­å·¥ä½œæ—¶æä¾›æŒ‡å¯¼ã€‚

## é¡¹ç›®æ¦‚è¿°

**reData** æ˜¯ä¸€ä¸ªåŸºäº Tauri æ„å»ºçš„æ™ºèƒ½æ•°æ®å¤„ç†å¹³å°æ¡Œé¢åº”ç”¨ã€‚å®ƒæ˜¯ä¸€ä¸ªå¤šé¡¹ç›®ç®¡ç†ç³»ç»Ÿï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºä¸åŒçš„é¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®å¯ä»¥è‡ªå®šä¹‰éœ€è¦æå–çš„å­—æ®µã€‚ç³»ç»Ÿä½¿ç”¨ AI æ¨¡å‹è‡ªåŠ¨è¯†åˆ«è¡¨å¤´ï¼Œå¹¶ä»æ•°ç™¾ä¸‡ä¸ªéæ ‡å‡†åŒ–çš„ Excel æ–‡ä»¶ä¸­æå–ç»“æ„åŒ–æ•°æ®ã€‚

**æ ¸å¿ƒèƒ½åŠ›**ï¼š
- **å¤šé¡¹ç›®ç®¡ç†**ï¼šç”¨æˆ·å¯ä»¥åˆ›å»ºå¤šä¸ªç‹¬ç«‹é¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®æœ‰ç‹¬ç«‹çš„å­—æ®µå®šä¹‰å’Œæ•°æ®å­˜å‚¨
- **çµæ´»çš„å­—æ®µå®šä¹‰**ï¼šä½¿ç”¨ç±» Excel çš„è¡¨æ ¼ç¼–è¾‘å™¨ï¼Œè½»æ¾å®šä¹‰éœ€è¦æå–çš„å­—æ®µ
- **AI åˆ—æ˜ å°„åˆ†æ**ï¼šæ¯ Sheet ä»… 1 æ¬¡ AI è°ƒç”¨ï¼Œåˆ†æè¡¨å¤´ä½ç½®å’Œåˆ—æ˜ å°„å…³ç³»
- **æœ¬åœ°éªŒè¯å¯¼å…¥**ï¼šæ ¹æ®æ˜ å°„ç»“æœç›´æ¥è¯»å–æ•°æ®ï¼Œä½¿ç”¨æ ¼å¼è§„åˆ™éªŒè¯ï¼ˆèŠ‚çœ 99.9% AI è°ƒç”¨ï¼‰
- **å¯é…ç½®å»é‡**ï¼šæ¯ä¸ªé¡¹ç›®å¯ä»¥è®¾ç½®æ˜¯å¦å»é‡ï¼Œä»¥åŠæŒ‰å“ªäº›å­—æ®µå»é‡
- **å¤šæ–‡ä»¶å¹¶è¡Œå¤„ç†**ï¼šå®æ—¶è¿›åº¦è·Ÿè¸ª
- **æœ¬åœ° SQLite å­˜å‚¨**ï¼šæ¯ä¸ªé¡¹ç›®ç‹¬ç«‹å­˜å‚¨ï¼Œå®Œæ•´æ•°æ®å¯è¿½æº¯
- **AI è¾…åŠ©å­—æ®µå®šä¹‰**ï¼šè‡ªåŠ¨ç”Ÿæˆè‹±æ–‡å­—æ®µåå’Œæå–æç¤º

## æŠ€æœ¯æ ˆ

**å‰ç«¯**: Nuxt 4.x + TypeScript + Nuxt UI 4.x
**æ¡Œé¢æ¡†æ¶**: Tauri 2.x
**åç«¯**:
- **Python 3.11+ + FastAPI** (ç”Ÿäº§ç‰ˆæœ¬)
- **Rust + Axum** (æ–°å®ç°ï¼Œé«˜æ€§èƒ½ç‰ˆæœ¬) ğŸš€
**æ•°æ®åº“**: SQLite 3.40+
**AI é›†æˆ**: OpenAI SDKï¼ˆæ”¯æŒ GPT-4ã€Claudeã€é€šè¿‡ Ollama çš„æœ¬åœ°æ¨¡å‹ï¼‰

**å‰ç«¯ç‰¹æ€§**ï¼š
- Nuxt 4.x - æœ€æ–°ç‰ˆï¼Œå…¨æ ˆ Vue æ¡†æ¶
- Nuxt UI 4.x - åŸºäº Reka UI å’Œ Tailwind CSS çš„ç›´è§‚ UI åº“
- è‡ªåŠ¨è·¯ç”± - åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„è·¯ç”±
- å†…ç½® Pinia - çŠ¶æ€ç®¡ç†
- TypeScript æ”¯æŒ - å®Œæ•´çš„ç±»å‹å®‰å…¨

**åç«¯ç‰¹æ€§**ï¼š

**Python + FastAPI**ï¼ˆç”Ÿäº§ç‰ˆæœ¬ï¼‰ï¼š
- FastAPI - ç°ä»£ Python Web æ¡†æ¶ï¼Œè‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- SQLAlchemy - Python ORMï¼Œç±»å‹å®‰å…¨çš„æ•°æ®åº“æ“ä½œ
- pandas + openpyxl - å¼ºå¤§çš„ Excel å¤„ç†èƒ½åŠ›
- OpenAI SDK - å®˜æ–¹ AI é›†æˆåº“
- uvicorn - é«˜æ€§èƒ½ ASGI æœåŠ¡å™¨

**Rust + Axum**ï¼ˆæ–°å®ç°ï¼Œé«˜æ€§èƒ½ç‰ˆæœ¬ï¼‰ğŸš€ï¼š
- Axum 0.7 - é«˜æ€§èƒ½å¼‚æ­¥ Web æ¡†æ¶
- SeaORM 1.0 - å¼‚æ­¥ ORMï¼Œæ”¯æŒ SQLite
- async-openai 0.24 - OpenAI API å®¢æˆ·ç«¯
- calamine + rust_xlsxwriter - Excel å¤„ç†
- tokio - å¼‚æ­¥è¿è¡Œæ—¶
- DDD æ¶æ„ - é¢†åŸŸé©±åŠ¨è®¾è®¡
- æ€§èƒ½æå‡ï¼šå¯åŠ¨æ—¶é—´ ~1ç§’ï¼Œå†…å­˜å ç”¨ ~10MBï¼ŒAPI å“åº” <5ms

## æ¶æ„

### é€šä¿¡æ¨¡å¼

åº”ç”¨ä½¿ç”¨ HTTP API è¿›è¡Œå‰åç«¯é€šä¿¡ï¼š

**å‰ç«¯ â†’ åç«¯**: é€šè¿‡ HTTP API è°ƒç”¨åç«¯æœåŠ¡
- Python åç«¯ï¼šhttp://127.0.0.1:8000
- Rust åç«¯ï¼šhttp://127.0.0.1:8001 ğŸš€

**åç«¯ â†’ å‰ç«¯**: é€šè¿‡ WebSocket è¿›è¡Œå®æ—¶è¿›åº¦æ›´æ–°

**åˆ‡æ¢åç«¯**ï¼šå‰ç«¯æ”¯æŒé€šè¿‡é…ç½®åˆ‡æ¢ä½¿ç”¨ Python æˆ– Rust åç«¯ï¼ˆé»˜è®¤ä½¿ç”¨ Rustï¼‰

### API è·¯ç”±ï¼ˆä½äº `backend/src/redata/api/`ï¼‰ï¼š

- `projects.py` - é¡¹ç›®çš„ CRUD æ“ä½œ âœ…
- `fields.py` - å­—æ®µå®šä¹‰çš„ CRUD æ“ä½œ âœ…
- `ai_configs.py` - AI é…ç½®çš„ CRUD æ“ä½œ âœ…
- `files.py` - æ–‡ä»¶ä¸Šä¼ ã€é¢„è§ˆã€æ‰¹æ¬¡ç®¡ç† âœ…
- `processing.py` - å¯åŠ¨/æš‚åœ/æ¢å¤/å–æ¶ˆå¤„ç†ä»»åŠ¡ã€WebSocket è¿›åº¦ âœ…
- `results.py` - æŸ¥è¯¢/æ›´æ–°/å¯¼å‡ºæå–çš„è®°å½• âœ…

### æœåŠ¡å±‚æ¶æ„ï¼ˆä¸¤é˜¶æ®µå¤„ç†æ–¹æ¡ˆï¼‰

**æœåŠ¡**ï¼ˆä½äº `backend/src/redata/services/`ï¼‰ï¼š

| æ–‡ä»¶ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|
| `ai_client.py` | AI åˆ—æ˜ å°„åˆ†æã€å­—æ®µå…ƒæ•°æ®ç”Ÿæˆ | âœ… |
| `validator.py` | æœ¬åœ°æ ¼å¼éªŒè¯ã€æ•°æ®æ ‡å‡†åŒ– | âœ… |
| `excel_parser.py` | Excel è¯»å–ã€æŒ‰åˆ—ç´¢å¼•è¯»å– | âœ… |
| `storage.py` | åŠ¨æ€è¡¨ç®¡ç†ã€å»é‡å¤„ç† | âœ… |
| `extractor.py` | ä¸¤é˜¶æ®µå¤„ç†åè°ƒå™¨ | âœ… |

**ä¸¤é˜¶æ®µå¤„ç†æµç¨‹**ï¼š

**é˜¶æ®µä¸€ï¼šAI åˆ—æ˜ å°„åˆ†æï¼ˆæ¯ Sheet ä»… 1 æ¬¡ AI è°ƒç”¨ï¼‰**
1. è¯»å–å‰ 10 è¡Œæ ·æœ¬æ•°æ®
2. AI è¯†åˆ«è¡¨å¤´ä½ç½®ï¼ˆç¬¬ 1-10 è¡Œï¼Œæˆ–æ— è¡¨å¤´ï¼‰
3. AI åˆ†ææ¯ä¸€åˆ—ä¸é¡¹ç›®å­—æ®µçš„åŒ¹é…å…³ç³»
4. è¿”å›åˆ—æ˜ å°„å’Œç½®ä¿¡åº¦

**é˜¶æ®µäºŒï¼šæœ¬åœ°éªŒè¯å¯¼å…¥ï¼ˆæ—  AI è°ƒç”¨ï¼‰**
1. æ ¹æ®åˆ—æ˜ å°„ç›´æ¥è¯»å–å¯¹åº”åˆ—
2. ä½¿ç”¨æ ¼å¼éªŒè¯è§„åˆ™æ£€æŸ¥æ•°æ®
3. é€è¡Œå¯¼å…¥åˆ°æ•°æ®åº“

**Token èŠ‚çœå¯¹æ¯”**ï¼š
- æ—§æ–¹æ¡ˆï¼š1 ä¸ª Sheet æœ‰ 1000 è¡Œ = 1000 æ¬¡ AI è°ƒç”¨
- æ–°æ–¹æ¡ˆï¼š1 ä¸ª Sheet = 1 æ¬¡ AI è°ƒç”¨
- **èŠ‚çœ 99.9% çš„ AI è°ƒç”¨**

### çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰

**ä¸»è¦ store**ï¼š
- `projectStore` - é¡¹ç›®åˆ—è¡¨ã€å½“å‰é¡¹ç›®ã€é¡¹ç›® CRUD
- `fieldStore` - å­—æ®µå®šä¹‰ã€å­—æ®µç¼–è¾‘
- `processingStore` - æ´»åŠ¨ä»»åŠ¡ã€è¿›åº¦ã€é€‰ä¸­çš„ä»»åŠ¡
- `resultStore` - æå–çš„è®°å½•ã€åˆ†é¡µã€ç­›é€‰å™¨
- `configStore` - AI é…ç½®ã€é»˜è®¤é…ç½®
- `tabStore` - å…¨å±€æ ‡ç­¾é¡µçŠ¶æ€ç®¡ç†

### å®æ—¶è¿›åº¦æ›´æ–°

ä½¿ç”¨ WebSocketï¼š

```python
# åç«¯å‘é€è¿›åº¦äº‹ä»¶ï¼ˆFastAPIï¼‰
await manager.broadcast(task_id, {
    "event": "row_processed",
    "current_row": 100,
    "total_rows": 500,
    "success_count": 95,
    "error_count": 5
})
```

```typescript
// å‰ç«¯ç›‘å¬å¹¶æ›´æ–° UI
const ws = new WebSocket('ws://127.0.0.1:8000/api/processing/ws/progress/{task_id}')
ws.onmessage = (event) => {
  const progress = JSON.parse(event.data)
  processingStore.updateProgress(progress)
}
```

## æ•°æ®åº“æ¶æ„

**æ ¸å¿ƒè¡¨**ï¼š

1. **projects** - é¡¹ç›®è¡¨ï¼ŒåŒ…å«é¡¹ç›®åç§°ã€æè¿°ã€å»é‡é…ç½®
2. **project_fields** - é¡¹ç›®å­—æ®µå®šä¹‰è¡¨ï¼ŒåŒ…å«å­—æ®µåã€æ˜¾ç¤ºåç§°ã€ç±»å‹ã€éªŒè¯è§„åˆ™ã€AI æå–æç¤º
3. **project_{id}_records** - åŠ¨æ€åˆ›å»ºçš„é¡¹ç›®æ•°æ®è¡¨ï¼Œæ¯ä¸ªé¡¹ç›®ä¸€ä¸ªç‹¬ç«‹çš„è¡¨ï¼Œè¡¨ç»“æ„æ ¹æ®é¡¹ç›®å­—æ®µå®šä¹‰åŠ¨æ€ç”Ÿæˆ
4. **processing_tasks** - ä»»åŠ¡è·Ÿè¸ªï¼ŒUUID ä¸»é”®ï¼ŒçŠ¶æ€æšä¸¾ï¼ˆpending/processing/paused/completed/cancelledï¼‰
5. **ai_configs** - AI æ¨¡å‹é…ç½®ï¼ŒåŠ å¯†çš„ API å¯†é’¥ï¼Œis_default æ ‡å¿—
6. **batches** - æ‰¹æ¬¡ç»Ÿè®¡ï¼ˆbatch_001ã€batch_002...ï¼‰

**å…³é”®ç‰¹æ€§**ï¼š
- æ¯ä¸ªé¡¹ç›®åˆ›å»ºç‹¬ç«‹çš„æ•°æ®è¡¨ï¼ˆ`project_{id}_records`ï¼‰
- è¡¨ç»“æ„æ ¹æ®é¡¹ç›®å­—æ®µå®šä¹‰åŠ¨æ€ç”Ÿæˆ
- æ”¯æŒåŠ¨æ€æ·»åŠ /åˆ é™¤å­—æ®µï¼ˆALTER TABLE æˆ–é‡å»ºè¡¨ï¼‰
- æ ¹æ®é¡¹ç›®å»é‡é…ç½®åˆ›å»ºç›¸åº”çš„ UNIQUE ç´¢å¼•

**å…³é”®ç´¢å¼•**ï¼š
- é¡¹ç›®æ•°æ®è¡¨æ ¹æ®å»é‡é…ç½®åŠ¨æ€åˆ›å»ºç´¢å¼•
- `idx_task_status` on processing_tasks(status) - æ´»åŠ¨ä»»åŠ¡æŸ¥è¯¢
- `idx_project_id` on project_fields(project_id) - å­—æ®µæŸ¥è¯¢

## å¼€å‘å‘½ä»¤

### åˆå§‹è®¾ç½®

```bash
# å®‰è£…å‰ç«¯ä¾èµ–
npm install

# å®‰è£…åç«¯ä¾èµ–
cd backend
uv sync
cd ..
```

### å¼€å‘

```bash
# å¯åŠ¨ Python åç«¯æœåŠ¡å™¨
cd backend
uv run python run.py

# å¯åŠ¨ Rust åç«¯æœåŠ¡å™¨ï¼ˆæ¨èï¼‰ğŸš€
cd redata-app/src-tauri
cargo run --bin server

# å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼ˆå¦ä¸€ä¸ªç»ˆç«¯ï¼‰
npm run dev

# å¯åŠ¨ Tauri å¼€å‘æ¨¡å¼ï¼ˆé›†æˆ Rust åç«¯ï¼‰
npm run tauri:dev

# ç”Ÿäº§æ„å»º
npm run tauri:build
```

### API æ–‡æ¡£

åç«¯ API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆï¼š
- Swagger UI: http://127.0.0.1:8000/docs
- ReDoc: http://127.0.0.1:8000/redoc

### æ•°æ®åº“

æ•°æ®åº“æ–‡ä»¶ä½ç½®ï¼š`backend/data/app.db`
é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºã€‚

å¼€å‘æœŸé—´é‡ç½®æ•°æ®åº“ï¼šåˆ é™¤ `backend/data/app.db` å¹¶é‡å¯åç«¯æœåŠ¡å™¨ã€‚

## å…³é”®å®ç°æ¨¡å¼

### ä¸¤é˜¶æ®µæ•°æ®å¤„ç†ï¼ˆé«˜æ•ˆæ¨¡å¼ï¼‰

```python
# é˜¶æ®µä¸€ï¼šAI åˆ—æ˜ å°„åˆ†æï¼ˆæ¯ Sheet ä»… 1 æ¬¡ï¼‰
mapping = await ai_client.analyze_column_mapping(
    sample_rows=sample_rows,  # å‰ 10 è¡Œ
    fields=project_fields
)
# è¿”å›: {header_row: 1, column_mappings: {0: "name", 2: "phone"}, confidence: 0.95}

# é˜¶æ®µäºŒï¼šæœ¬åœ°éªŒè¯å¯¼å…¥ï¼ˆæ—  AI è°ƒç”¨ï¼‰
for row_num, row_data in parser.iterate_rows(sheet, start_row):
    record = {field_name: row_data[col_idx] for col_idx, field_name in mapping.column_mappings.items()}
    is_valid, errors = validator.validate_record(record, fields)
    if is_valid:
        storage.insert_record(project_id, record, meta)
```

### æœ¬åœ°æ ¼å¼éªŒè¯

```python
class DataValidator:
    VALIDATORS = {
        "phone": r"^1[3-9]\d{9}$",           # 11ä½æ‰‹æœºå·
        "email": r"^[\w\.-]+@[\w\.-]+\.\w+$", # é‚®ç®±
        "url": r"^https?://",                # URL
        "date": r"^\d{4}[-/]\d{1,2}[-/]\d{1,2}$",  # æ—¥æœŸ
    }

    def validate(self, value, field):
        # å¿…å¡«æ£€æŸ¥
        if field.is_required and not value:
            return False, "å¿…å¡«å­—æ®µä¸èƒ½ä¸ºç©º"
        # ç±»å‹éªŒè¯
        if field.field_type in self.VALIDATORS:
            if not re.match(self.VALIDATORS[field.field_type], str(value)):
                return False, f"æ ¼å¼ä¸æ­£ç¡®"
        return True, None
```

### å»é‡å¤„ç†

```python
# æ ¹æ®é¡¹ç›®å»é‡é…ç½®åŠ¨æ€å¤„ç†
if project.dedup_enabled:
    existing_id = storage.handle_dedup(project, data)
    if existing_id:
        if project.dedup_strategy == "skip":
            return  # è·³è¿‡é‡å¤
        elif project.dedup_strategy == "update":
            storage.update_record(project_id, existing_id, data)
    else:
        storage.insert_record(project_id, data, meta)
```

### æš‚åœ/æ¢å¤æœºåˆ¶

```python
class Extractor:
    def __init__(self):
        self.paused = False
        self.cancelled = False

    async def process_sheet(self):
        for row in rows:
            while self.paused:
                await asyncio.sleep(0.1)
            if self.cancelled:
                break
            # å¤„ç†è¡Œ...
```

## æ–‡ä»¶ç»„ç»‡

### å‰ç«¯ç»“æ„

- `app/pages/` - é¡µé¢ç»„ä»¶ï¼ˆNuxt 4 è‡ªåŠ¨è·¯ç”±ï¼‰
  - `index.vue` - é¡¹ç›®åˆ—è¡¨é¡µï¼ˆé¦–é¡µï¼‰
  - `project/[id].vue` - é¡¹ç›®è¯¦æƒ…é¡µ
  - `project/[id]/fields.vue` - å­—æ®µå®šä¹‰é¡µï¼ˆAI è¾…åŠ©å­—æ®µç”Ÿæˆï¼‰
  - `project/[id]/processing.vue` - æ•°æ®å¤„ç†é¡µ
  - `project/[id]/results.vue` - ç»“æœå±•ç¤ºé¡µï¼ˆå›ºå®šè¡¨å¤´ã€50æ¡/é¡µï¼‰
  - `project/[id]/settings.vue` - é¡¹ç›®è®¾ç½®é¡µ
  - `settings.vue` - è®¾ç½®é¡µï¼ˆAI é…ç½®ç®¡ç†ï¼‰
- `components/` - å¯å¤ç”¨ç»„ä»¶
- `stores/` - Pinia stores
- `types/` - TypeScript ç±»å‹å®šä¹‰
- `utils/` - å·¥å…·å‡½æ•°ï¼ˆAPI å®¢æˆ·ç«¯ï¼‰

### åç«¯ç»“æ„

**Python åç«¯**ï¼ˆä½äº `backend/src/redata/`ï¼‰ï¼š

- `backend/src/redata/api/` - API è·¯ç”±ï¼ˆFastAPIï¼‰âœ…
  - `projects.py` - é¡¹ç›®ç®¡ç†
  - `fields.py` - å­—æ®µå®šä¹‰
  - `files.py` - æ–‡ä»¶æ“ä½œ
  - `processing.py` - æ•°æ®å¤„ç†
  - `ai_configs.py` - AI é…ç½®
  - `results.py` - ç»“æœæŸ¥è¯¢
- `backend/src/redata/services/` - ä¸šåŠ¡é€»è¾‘ âœ…
  - `ai_client.py` - AI å®¢æˆ·ç«¯ï¼ˆåˆ—æ˜ å°„åˆ†æï¼‰
  - `validator.py` - æ•°æ®éªŒè¯å™¨
  - `excel_parser.py` - Excel è§£æ
  - `extractor.py` - æ•°æ®æå–åè°ƒå™¨
  - `storage.py` - æ•°æ®å­˜å‚¨ï¼ˆåŠ¨æ€è¡¨ç®¡ç†ï¼‰
- `backend/src/redata/models/` - æ•°æ®æ¨¡å‹
- `backend/src/redata/db/` - æ•°æ®åº“é…ç½®

**Rust åç«¯**ï¼ˆä½äº `src-tauri/src/backend/`ï¼‰ğŸš€ï¼š

é‡‡ç”¨ DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰æ¶æ„ï¼š

- `domain/` - é¢†åŸŸå±‚ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼‰
  - `entities/` - å®ä½“
  - `value_objects/` - å€¼å¯¹è±¡
  - `repositories/` - ä»“å‚¨æ¥å£
  - `services/` - é¢†åŸŸæœåŠ¡
  - `events/` - é¢†åŸŸäº‹ä»¶
- `application/` - åº”ç”¨å±‚ï¼ˆç”¨ä¾‹ç¼–æ’ï¼‰
  - `use_cases/` - ç”¨ä¾‹
  - `dtos/` - æ•°æ®ä¼ è¾“å¯¹è±¡
  - `commands/` - å‘½ä»¤ï¼ˆå†™æ“ä½œï¼‰
  - `queries/` - æŸ¥è¯¢ï¼ˆè¯»æ“ä½œï¼‰
- `infrastructure/` - åŸºç¡€è®¾æ–½å±‚ï¼ˆæŠ€æœ¯å®ç°ï¼‰
  - `persistence/` - æŒä¹…åŒ–
    - `database.rs` - æ•°æ®åº“è¿æ¥ âœ…
    - `migrations.rs` - æ•°æ®åº“è¿ç§» âœ…
    - `models/` - ORM æ¨¡å‹ âœ…
    - `repositories/` - ä»“å‚¨å®ç°
  - `external_services/` - å¤–éƒ¨æœåŠ¡
  - `config/` - é…ç½®
    - `error.rs` - é”™è¯¯å¤„ç† âœ…
    - `logging.rs` - æ—¥å¿—ç³»ç»Ÿ âœ…
    - `crypto.rs` - åŠ å¯†å·¥å…· âœ…
- `presentation/` - è¡¨ç°å±‚ï¼ˆAPI æ¥å£ï¼‰
  - `api/` - API è·¯ç”±
    - `projects.rs` - é¡¹ç›® API âœ…
    - `fields.rs` - å­—æ®µ APIï¼ˆå¾…å®ç°ï¼‰
    - `ai_configs.rs` - AI é…ç½® APIï¼ˆå¾…å®ç°ï¼‰
    - `files.rs` - æ–‡ä»¶ APIï¼ˆå¾…å®ç°ï¼‰
    - `processing.rs` - å¤„ç†ä»»åŠ¡ APIï¼ˆå¾…å®ç°ï¼‰
    - `results.rs` - ç»“æœ APIï¼ˆå¾…å®ç°ï¼‰
  - `middleware/` - ä¸­é—´ä»¶
    - `cors.rs` - CORS é…ç½® âœ…
    - `logging.rs` - æ—¥å¿—ä¸­é—´ä»¶ âœ…

**Rust åç«¯å®ç°è¿›åº¦**ï¼š
- âœ… Phase 1: åŸºç¡€æ¶æ„æ­å»º
- âœ… Phase 2: æ•°æ®åº“å±‚å®ç°ï¼ˆåŒ…æ‹¬è¿ç§»ï¼‰
- âœ… Phase 3: é¡¹ç›®ç®¡ç† APIï¼ˆå®Œæ•´ CRUDï¼‰
- â³ Phase 4-9: å…¶ä»– API ç«¯ç‚¹ï¼ˆå¾…å®ç°ï¼‰

### æ•°æ®ç›®å½•

- `history/batch_XXX/` - å¤åˆ¶çš„ Excel æ–‡ä»¶ï¼ˆä¿ç•™åŸå§‹æ–‡ä»¶ï¼Œå®ç°å¯è¿½æº¯æ€§ï¼‰
- `backend/data/app.db` - SQLite æ•°æ®åº“æ–‡ä»¶

## é‡è¦çº¦å®š

### æ‰¹æ¬¡å¤„ç†

- å¤„ç†å‰æ–‡ä»¶è¢«å¤åˆ¶åˆ° `history/batch_XXX/`ï¼ˆæ‰¹æ¬¡å·è‡ªåŠ¨é€’å¢ï¼‰
- åŸå§‹æ–‡ä»¶ä¿æŒä¸å˜
- æ¯ä¸ªæ‰¹æ¬¡éƒ½æœ‰å”¯ä¸€æ ‡è¯†ç¬¦ä»¥å®ç°å¯è¿½æº¯æ€§

### é”™è¯¯å¤„ç†

- å¤±è´¥çš„è¡Œä¼šè¢«è®°å½•ä½†ä¸ä¼šåœæ­¢å¤„ç†
- é”™è¯¯æ¶ˆæ¯å­˜å‚¨åœ¨é¡¹ç›®æ•°æ®è¡¨çš„ `error_message` å­—æ®µ
- AI API å¤±è´¥ä¼šè§¦å‘è‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰

### ç©ºè¡Œæ£€æµ‹

- ç»´æŠ¤è¿ç»­ç©ºè¡Œè®¡æ•°å™¨
- è¿ç»­ 10 ä¸ªç©ºè¡Œåè·³åˆ°ä¸‹ä¸€ä¸ª sheet
- é‡åˆ°éç©ºè¡Œæ—¶è®¡æ•°å™¨é‡ç½®

### å¤š Sheet å¤„ç†

- æ¯ä¸ª sheet ç‹¬ç«‹è¿›è¡Œè¡¨å¤´è¯†åˆ«
- **å¦‚æœæœ‰è¡¨å¤´**ï¼šä»è¡¨å¤´è¡Œ + 1 å¼€å§‹å¤„ç†ï¼Œä½¿ç”¨"è¡¨å¤´:å€¼"æ ¼å¼
- **å¦‚æœæ— è¡¨å¤´**ï¼šä»ç¬¬ 1 è¡Œå¼€å§‹å¤„ç†ï¼Œç›´æ¥æäº¤åŸå§‹æ•°æ®ç»™ AI
- Sheet åç§°è®°å½•åœ¨ `source_sheet` å­—æ®µ
- æ–‡ä»¶å†…çš„æ‰€æœ‰ sheet æŒ‰é¡ºåºå¤„ç†

## æ–‡æ¡£

`prd/` ç›®å½•ä¸­çš„å®Œæ•´æ–‡æ¡£ï¼ˆv2.4.0ï¼‰ï¼š
- `prd.md` - äº§å“éœ€æ±‚å’Œä¸šåŠ¡é€»è¾‘ï¼ˆä¸¤é˜¶æ®µå¤„ç†æ–¹æ¡ˆï¼‰
- `design.md` - UI/UX è®¾è®¡åŠ ASCII å›¾è¡¨
- `plan.md` - å®æ–½è®¡åˆ’ï¼ˆ10 ä¸ªé˜¶æ®µï¼Œå½“å‰è¿›åº¦ 10/10ï¼‰
- `dev.md` - æŠ€æœ¯ç»†èŠ‚å’Œæ¶æ„ï¼ˆä¸¤é˜¶æ®µå¤„ç†å®ç°ï¼‰
- `README.md` - æ–‡æ¡£ç´¢å¼•

**å¼€å‘è¿›åº¦**ï¼š
- âœ… Phase 1: é¡¹ç›®åˆå§‹åŒ–ï¼ˆNuxt 4 + Tauri 2ï¼‰
- âœ… Phase 2: æ•°æ®åº“å’ŒåŸºç¡€æœåŠ¡ï¼ˆPython FastAPIï¼‰
- âœ… Phase 3: AI é›†æˆå’Œ Excel è§£æï¼ˆä¸¤é˜¶æ®µå¤„ç†æ–¹æ¡ˆï¼‰
- âœ… Phase 4: å‰ç«¯åŸºç¡€æ¶æ„ï¼ˆå¸ƒå±€ã€API å®¢æˆ·ç«¯ã€çŠ¶æ€ç®¡ç†ï¼‰
- âœ… Phase 5: å‰ç«¯ - é¡¹ç›®ç®¡ç†ï¼ˆé¡¹ç›®åˆ—è¡¨ã€åˆ›å»ºã€åˆ‡æ¢ï¼‰
- âœ… Phase 6: å‰ç«¯ - å­—æ®µå®šä¹‰ï¼ˆAI è¾…åŠ©å­—æ®µç”Ÿæˆå·¥ä½œæµï¼‰
- âœ… Phase 7: å‰ç«¯ - å¤„ç†ç•Œé¢ï¼ˆæ–‡ä»¶å¤„ç†ã€è¿›åº¦æ˜¾ç¤ºï¼‰
- âœ… Phase 8: å‰ç«¯ - ç»“æœé¡µé¢ï¼ˆæ•°æ®å±•ç¤ºã€ç¼–è¾‘ã€å¯¼å‡ºï¼‰
- âœ… Phase 9: UI ä¼˜åŒ–ï¼ˆå…¨å±€æ ‡ç­¾é¡µã€å¡ç‰‡å¸ƒå±€ã€å›ºå®šè¡¨å¤´ï¼‰
- âœ… Phase 10: åç«¯ API é›†æˆï¼ˆAI å­—æ®µç”Ÿæˆæ¥å£ï¼‰

**v2.4.0 é‡è¦å˜æ›´**ï¼š
- å®Œæˆæ‰€æœ‰ 10 ä¸ªå¼€å‘é˜¶æ®µ
- æ–°å¢å…¨å±€æ ‡ç­¾é¡µåŠŸèƒ½ï¼ˆæµè§ˆå™¨å¼ä½“éªŒï¼‰
- AI è¾…åŠ©å­—æ®µå®šä¹‰ï¼šè‡ªåŠ¨ç”Ÿæˆè‹±æ–‡å­—æ®µåã€éªŒè¯è§„åˆ™ã€æå–æç¤º
- ä¼˜åŒ– UIï¼šé¡¹ç›®å¡ç‰‡å¼¹æ€§å¸ƒå±€ã€ç»“æœé¡µé¢å›ºå®šè¡¨å¤´ï¼ˆ50æ¡/é¡µï¼‰
- æ–°å¢ `tab.ts` æ ‡ç­¾é¡µçŠ¶æ€ç®¡ç†
- æ•°æ®åº“æ–°å¢ `additional_requirement` å­—æ®µ

**v2.3.0 é‡è¦å˜æ›´**ï¼š
- é‡‡ç”¨"AI åˆ—æ˜ å°„åˆ†æ + æœ¬åœ°éªŒè¯å¯¼å…¥"çš„ä¸¤é˜¶æ®µå¤„ç†
- æ¯ Sheet ä»… 1 æ¬¡ AI è°ƒç”¨ï¼ŒèŠ‚çœ 99.9% çš„ Token æ¶ˆè€—
- æ–°å¢ `validator.py` æœ¬åœ°æ•°æ®éªŒè¯å™¨

## å®‰å…¨è€ƒè™‘

- API å¯†é’¥åœ¨å­˜å‚¨åˆ° `ai_configs` è¡¨ä¹‹å‰å¿…é¡»åŠ å¯†
- æ•°æ®åº“æ–‡ä»¶ï¼ˆ`data/app.db`ï¼‰ä¿æŒæœ¬åœ°ï¼Œæ°¸ä¸ä¸Šä¼ åˆ°äº‘ç«¯
- ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢ SQL æ³¨å…¥
- éªŒè¯æ–‡ä»¶è·¯å¾„ä»¥é˜²æ­¢ç›®å½•éå†æ”»å‡»

## å·²çŸ¥é—®é¢˜å’Œä¿®å¤

### WebSocket è¿æ¥é—®é¢˜ (v2.4.1)

**é—®é¢˜æè¿°**ï¼š
- æ–‡ä»¶å¯¼å…¥æ—¶ WebSocket è¿æ¥é”™è¯¯ï¼š"WebSocket è¿æ¥é”™è¯¯" å’Œ "å·²æ–­å¼€ä»»åŠ¡ ... çš„è¿›åº¦æµ"

**æ ¹æœ¬åŸå› **ï¼š
- åç«¯åœ¨åˆ›å»ºå¤„ç†ä»»åŠ¡æ—¶ï¼Œ`task_id` æ˜¯åœ¨åå°å¼‚æ­¥ä»»åŠ¡ä¸­æ‰ç”Ÿæˆçš„
- å¯¼è‡´ API è¿”å›çš„ `task_id` ä¸ºç©ºå­—ç¬¦ä¸² `""`
- å‰ç«¯æ— æ³•é€šè¿‡ç©ºçš„ task_id è¿æ¥åˆ° WebSocket

**ä¿®å¤æ–¹æ¡ˆ**ï¼š
- åœ¨ `backend/src/redata/api/processing.py` çš„ `start_processing` å‡½æ•°ä¸­ï¼Œæå‰ç”Ÿæˆ `task_id` å’Œ `batch_number`
- ç¡®ä¿ API è¿”å›å“åº”æ—¶å·²ç»åŒ…å«æ­£ç¡®çš„ task_id

**ç›¸å…³æ–‡ä»¶**ï¼š
- `backend/src/redata/api/processing.py` - ä¿®å¤äº† task_id ç”Ÿæˆé€»è¾‘
- `backend/src/redata/services/storage.py` - æ·»åŠ äº†æ™ºèƒ½è¡¨ç»“æ„è¿ç§»åŠŸèƒ½
- `backend/src/redata/models/project.py` - æ·»åŠ äº†å­—æ®µè½¯åˆ é™¤æ”¯æŒ (is_deleted, deleted_at)
- `backend/migrate_add_soft_delete.py` - æ•°æ®åº“è¿ç§»è„šæœ¬